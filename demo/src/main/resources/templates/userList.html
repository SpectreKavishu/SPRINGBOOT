<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	integrity="sha384-T384rR39DqvoDl7u1vMFqsklosWim6to4+nl2Hz37T8a46h8hF7rY67Ft0LOiu4w" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-C89scLLqNg519fKFByD4Bh4qpv8NXyTPH/7T1r1+(4+QRDmYl0pb51/uPnS9/QiW"
	crossorigin="anonymous"></script>


<head>
	<title>User List</title>
	<script>
		function submitForm(event) {
			event.preventDefault(); // Prevent the default form submission

			const form = document.getElementById('userForm');
			const formData = new FormData(form);

			// Create a JSON object from the form data
			const user = {};
			formData.forEach((value, key) => {
				user[key] = value;
			});

			fetch('http://localhost:8080/api/users', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json',
				},
				body: JSON.stringify(user),
			})
				.then(response => response.json())
				.then(data => {
					console.log('Success:', data);
					// Reload the page on success
					window.location.reload();
				})
				.catch((error) => {
					console.error('Error:', error);
				});
		}
	</script>
</head>

<body>
	<h1>User List</h1>
	<ul>
		<li th:each="user : ${users}">
			<span th:text="${user.name}"></span> - <span th:text="${user.email}"></span>
		</li>
	</ul>
	<div>
		<h2>Add new user: </h2>
	</div>
	<div>
		<form id="userForm" onsubmit="submitForm(event)">
			<label>Name: </label><input type="text" id="name" name="name" required placeholder="Enter Name" /><br>
			<label>Email: </label><input type="text" id="email" name="email" required placeholder="Enter Email" /><br>
			<input type="submit" value="Create" class="btn btn-primary"/>
		</form>
	</div>
	<div>
		<p>
			<a href="/">Home</a>
		</p>
	</div>
</body>

</html>